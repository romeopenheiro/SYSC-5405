---
title: "BIOM/SYSC 5405: Pattern Classification and Experiment Design"
subtitle: "Assignment 1"
author: 
- name: "Romeo Penheiro"
  affiliation: Department of Cognitive Science, Carleton University
date: "11/09/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, message = FALSE, echo=T}
# Install xfun so that I can use xfun::pkg_load2
if (!requireNamespace('xfun')) install.packages('xfun')
xf <- loadNamespace('xfun')

cran_packages = c(
                  "dplyr", 
                  "ggplot2", 
                  "knitr", 
                  "readxl", 
                  "tibble",
                  "skimr",
                  "kableExtra",
                  "gridExtra",
                  "here",
                  "utils"
                  )
if (length(cran_packages) != 0) xf$pkg_load2(cran_packages)

import::from(magrittr, '%>%')
gg <- import::from(ggplot2, .all=TRUE, .into={new.env()})
dp <- import::from(dplyr, .all=TRUE, .into={new.env()})
```

load the files

```{r}
pci_raw <- readxl::read_xls(path = here::here("data", "assigData1.xls"), 
                            sheet = "PCI")
```

```{r}
psipred_raw <- readxl::read_xls(path = here::here("data", "assigData1.xls"), 
                            sheet = "PSIPRED")
```

```{r}
feature_raw_data <- utils::read.table(file = here::here("data", "assigData2.tsv"), sep = '\t', header = TRUE)
feature_raw_data
```

# Explore the data 
```{r}
tibble::glimpse(pci_raw)
```

```{r}
tibble::glimpse(psipred_raw)
```

# Question 1: Classifier scores

```{r}
q3_length_pci <- gg$ggplot(data = pci_raw, mapping = gg$aes(x = Length, y = Q3)) +
  gg$geom_jitter()
q3_length_pci

```

```{r}
q3_length_psipred <- gg$ggplot(data = psipred_raw, mapping = gg$aes(x = Length, y = Q3)) +
  gg$geom_jitter()
q3_length_psipred

```
Based on these plots, there does not seem to be a correlation between Q3 accuracy 
with protein length for both the methods.

Spearmen co-relation between the two variables

```{r}
cor.test(pci_raw$Length, pci_raw$Q3,
         method = "spearman",
         exact = FALSE)
```

```{r}
cor.test(psipred_raw$Length, psipred_raw$Q3,
         method = "spearman",
         exact = FALSE)
```
Why did I use Spearman's correlation?
https://ademos.people.uic.edu/Chapter22.html
http://www.statstutor.ac.uk/resources/uploaded/spearmans.pdf
https://www.quora.com/What-is-the-difference-between-dependence-and-correlation

mean, median, and standard deviation of the Matthewsâ€™ correlation coefficien


```{r echo=T}
# Using the `skimr` function
# Create a template function for descriptives
my_skim <- skimr::skim_with(base = skimr::sfl(n = length, 
                                              missing =skimr::n_missing),
                            numeric = skimr::sfl(mean, 
                                                 sd, 
                                                 iqr = IQR, # stats::IQR
                                                 min, 
                                                 p25 = ~ quantile(., 1/4), 
                                                 median, 
                                                 p75 = ~ quantile(., 3/4), 
                                                 max
                                                 ), append = FALSE
) #sfl stands for "skimr function list"

```


```{r}
my_skim(pci_raw$CC)
```

```{r}
my_skim(psipred_raw$CC_AVG)
```

# Question 2: Feature data

```{r}
my_skim(feature_raw_data)
```

histograms for each feature

```{r}
# value = c(feature_raw_data$W_apl, feature_raw_data$W_orng, feature_raw_data$W_grp)
# gg$ggplot(data = feature_raw_data, mapping = gg$aes(x = value) +
#                 gg$geom_histogram((color="#e9ecef", 
#                                    alpha=0.6, 
#                                    position = 'identity', 
#                           #binwidth = 2.5,
#                                     alpha = 0.6) +
#         gg$labs(x = "Weight", 
#                 y = "Frequency", 
#                 title = "A histogram of the feature weight."))
#         )

dat <- data.frame(W_apl = feature_raw_data$W_apl,
                  W_orng = feature_raw_data$W_orng,
                  W_grp = feature_raw_data$W_grp)

gg$ggplot(data = feature_raw_data, mapping = gg$aes()) +
    gg$geom_histogram(mapping = gg$aes(x = W_apl), fill = "red", color = "red", alpha = 0.5, position = "identity") +
    gg$geom_histogram(mapping = gg$aes(x = W_orng), fill = "blue", color = "blue", alpha = 0.5, position = "identity") +
    gg$geom_histogram(mapping = gg$aes(x = W_grp), fill = "green", color = "green", alpha = 0.5, position = "identity") +
    gg$scale_fill_manual(name="Feature", values=c("red","blue", "green"),labels=c("a","b")) +
    gg$labs(x = "Weight", 
                 y = "Frequency", 
                 title = "A histogram of the feature weight.")
```


# Question 3: Generating data & the normal distribution
```{r message=F, echo=F}
df_sales <- readr::read_csv("https://query.data.world/s/e76we3vpgut5cmydqgm2nb7e5xqx7i", 
                            col_types = readr::cols(
                                             order_id = readr::col_integer(), 
                                             shop_id = readr::col_integer(), 
                                             user_id = readr::col_integer(), 
                                             order_amount = readr::col_double(), 
                                             total_items = readr::col_integer(), 
                                             payment_method = readr::col_factor(), 
                                             created_at = readr::col_datetime(format = "%Y-%m-%d %H:%M:%z")
                                             )
)
# df_sales # sanity check to make sure the data has been imported correctly
```

# Eyeball the data



Print out the first three rows to get an idea of what the data actually look like. 

```{r first-three_rows_df_sales}
head(df_sales, 3) %>% 
  knitr::kable(
               caption = "First three rows of the `df_sales` data frame"
  )
```

# Check for extreme values
```{r max_min_values}
df_sales_table <- df_sales %>%
        dp$summarise(min_order_amount = min(order_amount),
                    max_order_amount = max(order_amount),
                    min_total_items = min(total_items),
                    max_total_items = max(total_items))

df_sales_table %>%
  kableExtra::kbl(caption = "Minimum and maximum of `order_amount` and `total_items.`", row.names = T) %>%
  kableExtra::kable_material("striped")
```

visualize if values are outliers

```{r histogram_box-plot_order_amount}
histo_plot <- gg$ggplot(data = df_sales, mapping = gg$aes(x = order_amount)) +
        gg$geom_histogram(bins = 50, alpha = 0.15, color = "gray50") +
        gg$scale_x_log10(labels=scales::comma)

box_plot <- gg$ggplot(data = df_sales, mapping = gg$aes(x = "", y = order_amount)) +
        gg$geom_boxplot() +
        gg$scale_y_log10(labels=scales::comma) +
        gg$coord_flip() 

gridExtra::grid.arrange(histo_plot, box_plot, nrow = 2)
```
